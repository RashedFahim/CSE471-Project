<?php

namespace App\Http\Controllers\Agent;

use App\Http\Controllers\Controller;
use Illuminate\Http\Request;
use App\Models\Property;
use App\Models\MultiImage;
use App\Models\Facility;
use App\Models\Amenities;
use App\Models\PropertyType;
use App\Models\User;
use Intervention\Image\Facades\Image;
use Haruncpi\LaravelIdGenerator\IdGenerator;
use Carbon\Carbon;
use Illuminate\Support\Facades\Auth;
use DB;

class AgentPropertyController extends Controller
{
    public function AgentAllProperty(){

        $id = Auth::user()->id;
        $property = Property::where('agent_id',$id)->latest()->get();
        return view('agent.property.all_property',compact('property'));

    } // End Method 




    


    $id = Auth::user()->id;
    $property = User::where('role','agent')->where('id',$id)->first();
    $pcount = $property->credit;
    // dd($pcount);

    if ($pcount == 1) {
       return redirect()->route('buy.package');
    }else{

        return view('agent.property.add_property',compact('propertytype','amenities'));
    }
    




    public function AgentStoreProperty(Request $request){

        $id = Auth::user()->id;
        $uid = User::findOrFail($id);
        $nid = $uid->credit;
        






































































































































































































































































































































































        public function BuyBusinessPlan(){

            $id = Auth::user()->id;
            return view('agent.package.business_plan',compact('id'));
            
        }// End Method 






































































































        User::where('id',$id)->update([
            'credit' => DB::raw('1 + '.$nid),
        ]);
    }






































































































































































































































































    public function BuyPackage(){

        return view('agent.package.buy_package');
    }// End Method     
} 
